<#@ template debug="false" hostspecific="True" language="C#" #>
<#@ output extension=".txt" #>
<#@ Assembly Name="$(SolutionDir)References\AppSimplicity.SchemaDiscovery.dll" #>
<#+

    void GeneratePOCOClass(AppSimplicity.SchemaDiscovery.Entities.Table table) 
    { 
#>
Imports AppSimplicity.ActiveRecord

Namespace <#= table.DataSource.GeneratedNamespace #>
    ''' <summary>
    ''' <#= table.Summary #>
    ''' </summary>
    Partial Public Class <#= table.ClassName #>
        Implements IActiveRecord, IEntity

<#+
    foreach (AppSimplicity.SchemaDiscovery.Entities.Column column in table.Columns)
    {
        if ((column.IsIdentity) || (column.ColumnName.ToLower() == "id"))
        { 
#>
        Private _<#= column.PropertyName #> As Integer
        ''' <summary>
        ''' <#= column.Summary #>
        ''' </summary>        
        Public Property <#= column.PropertyName #> As Integer Implements AppSimplicity.ActiveRecord.IActiveRecord.Id
            Get
                Return _<#= column.PropertyName #>
            End Get
            Set(ByVal value As Integer)
                _<#= column.PropertyName #> = value
            End Set
        End Property

<#+
		}
        else 
        {
            string targetType = column.CLRTargetType;
            if (column.IsCLRNullable == true) 
            {
                targetType = string.Format("Nullable(Of {0})", column.CLRTargetType);
            }
#>
        Private _<#= column.PropertyName #> As <#= targetType #>
        ''' <summary>
        ''' <#= column.Summary #>
        ''' </summary>
        Public Property <#= column.PropertyName #>() As <#= targetType #>
            Get
                Return _<#= column.PropertyName #>
            End Get
            Set(ByVal value As <#= targetType #>)
                _<#= column.PropertyName #> = value
            End Set
        End Property	
			
<#+
		}
#>
<#+    
    }
#>
        Private _IsLoadedFromDB As Boolean = False
        Public Property IsLoadedFromDB As Boolean Implements AppSimplicity.ActiveRecord.IEntity.IsLoadedFromDB
            Get
                Return _IsLoadedFromDB
            End Get
            Set(ByVal value As Boolean)
                _IsLoadedFromDB = value
            End Set
        End Property

    End Class
End Namespace
			
<#+
	}
#>
